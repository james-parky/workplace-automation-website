<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Difficulties</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Montserrat:300,400,500,600,700" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">

  <!-- =======================================================
  * Template Name: Rapid - v4.7.0
  * Template URL: https://bootstrapmade.com/rapid-multipurpose-bootstrap-business-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top d-flex align-items-center header-transparent">
    <div class="container d-flex align-items-center">
      <h1 class="logo me-auto">
        <a href="index.html">Team 42 - Modern Workplace Automation</a>
      </h1>
    </div>

    <!-- Navbar -->
    <nav id="navbar" class="navbar order-last order-lg-0">
      <ul>
        <li>
          <a class="nav-link scrollto active" href="index.html">Home</a>
        </li>
        <li>
          <a class="nav-link scrollto active" href="index.html#requirements">Requirements</a>
        </li>
        <li>
          <a class="nav-link scrollto active" href="index.html#research">Research</a>
        </li>
        <li>
          <a class="nav-link scrollto active" href="index.html#algorithms">Algorithms</a>
        </li>
        <li>
          <a class="nav-link scrollto active" href="index.html#ui-design">UI Design</a>
        </li>
        <li>
          <a class="nav-link scrollto active" href="index.html#system-design">System Design</a>
        </li>
        <li>
          <a class="nav-link scrollto active" href="index.html#implementation">Implementation</a>
        </li>
        <li>
          <a class="nav-link scrollto active" href="index.html#testing">Testing</a>
        </li>
        <li>
          <a class="nav-link scrollto active" href="index.html#evaluation">Evaluation</a>
        </li>
        <li class="dropdown"><a hred="#appendix">Appendix <i class="bi bi-chevron-down"></i></a>
          <ul>
            <li><a href="appendix-gdpr">GDPR Statement</a></li>
            <li><a href="blog-page.html">Development Blog</a></li>
            <li><a href="appendix-video">Monthly Video</a></li>
            <li><a href="difficulties-page.html">Feedback for Microsoft</a></li>
          </ul>
        </li>
      </ul>
      <i class="bi bi-list mobile-nav-toggle"></i>
    </nav>
    <!-- End Navbar -->

  </header>
  <!-- End Header -->

  <main id="main">

    <!-- ======= Breadcrumbs ======= -->
    <section id="breadcrumbs" class="breadcrumbs">
      <div class="container">

        <ol>
          <li><a href="index.html">Home</a></li>
          <li>Feedback</li>
        </ol>
      </div>
    </section><!-- End Breadcrumbs -->

    <!-- ======= F.A.Q Section ======= -->
    <section id="faq" class="faq">
      <div class="container-fluid" data-aos="fade-up">

        <div class="row gy-4">

          <div class="col-lg-7 d-flex flex-column justify-content-center align-items-stretch  order-2 order-lg-1">

            <div class="content px-xl-5">
              <h3><strong>Feedback</strong></h3>
              <p>
                Below is a list of issues we faced when developing our project, how we worked around them, and suggested solutions to
                make Microsoft PowerApps more easy to learn and use in the future.
              </p>
            </div>

            <div class="accordion accordion-flush" id="faqlist">

              <!-- Issue Template
              <!- Start Issue --
              <div class="accordion-item" data-aos="fade-up" data-aos-delay="200">
                <h3 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq-content-1">
                    Issue Title
                  </button>
                </h3>
                <div id="faq-content-1" class="accordion-collapse collapse" data-bs-parent="#faqlist">
                  <div class="accordion-body">
                    <strong>Description: </strong> *Issue description*
                    <br><br>
                    <strong>Workaround: </strong> *workaround*
                    <br><br>
                    <strong>Suggested Solution: </strong>*solution*
                  </div>
                </div>
              </div>
              <-- End Issue --
              End Issue Template -->

              <!-- Start Issue -->
              <div class="accordion-item" data-aos="fade-up" data-aos-delay="200">
                <h3 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq-content-2">
                    N:N Relationships
                  </button>
                </h3>
                <div id="faq-content-2" class="accordion-collapse collapse" data-bs-parent="#faqlist">
                  <div class="accordion-body">
                    <strong>Description: </strong>
                    We have a table called Supervisor Responses that holds our users’ (the supervisors’) responses to a Supervisor 
                    Application. The Supervisor Application is an advanced form belonging to the Supervisor Responses table. 
                    Another table called ACM Classification Codes holds records which represent keywords we want our user to select from.
                    They should be able to select more than one keyword.
                    <br><br>

                    <strong>Attempted Solution: </strong>
                    This situation calls for a N:N relationship. We attempted to create a many-to-many relationship between Supervisor 
                    Responses and ACM Classification Codes using the built-in option (Supervisor Responses table > Relationships > Add 
                    relationship > Many-to-many; select ACM Classification Codes). This enabled us to use a subgrid in the form to 
                    enable the user to select multiple ACM keywords while filling out the form.
                    <br><br>
                    The issue arose when we attempted to store additional information about the relationship between Supervisor 
                    Responses and ACM Classification Codes. We also needed to store a lookup to the Contact table to be able to relate 
                    each selected ACM keyword to a specific user. We understood that when a many-to-many relationship is created in this
                    way a hidden table is created, forming the structure: Supervisor Responses <strong>1:N</strong> Hidden Table 
                    <strong>N:1</strong> ACM Classification Codes.
                    <br><br>
                    To be able to store the extra Contact lookup column, we wanted to access the records in this hidden table and copy 
                    them into another table (along with the additional data). We were able to view the records of the hidden table using
                    the FetchXML tool in XRMToolbox. However, when we attempted to reproduce this retrieval using an automated cloud 
                    flow, it was not possible. The List Rows step could not see the hidden table we were trying to retrieve rows from, 
                    so the FetchXML we added to that step was never run.
                    <br><br>

                    <strong>Workaround: </strong>We had to scrap the many-to-many relationship and create a new table called 
                    Supervisor-ACM to act in place of the hidden table. The Supervisor-ACM table has 4 columns:
                    <ul>
                      <li>ID (Autonumber)</li>
                      <li>Contacts (Lookup into Contact table)</li>
                      <li>ACM Keyword (Lookup into ACM Classification Codes)</li>
                      <li>Supervisor Response ID (Lookup into Supervisor Responses</li>
                    </ul>
                    With this new method, the subgrid became more cumbersome to use. We had to create a basic form in the Supervisor-ACM 
                    table to select and submit a single ACM keyword at a time. The basic form is triggered through the subgrid 
                    configuration as shown below.
                    <br><br>
                    <img class="accordion-img" src="assets/img/new-advanced-form-metadata.png">
                    <br><br>
                    As shown in the following three images, the process of selecting a keyword is lengthier and more awkward than 
                    using a subgrid with a many-to-many relationship.
                    <br><br>
                    <img class="accordion-img" src="assets/img/select-keywords1.png">
                    <br><br>
                    <img class="accordion-img" src="assets/img/select-keywords2.png">
                    <br><br>
                    <img class="accordion-img" src="assets/img/select-keywords3.png">
                    <br><br>
                    This process must be repeated for each keyword, as multiple selections are not possible. When keywords are 
                    submitted (as in the previous image), a record is automatically added to the Supervisor-ACM table containing the 
                    autonumber ID, ACM Keyword, and Supervisor Response. The Contact field is also automatically populated using a flow.
                    <br><br>

                    <strong>Suggested Solution: </strong>I was expecting that it would be possible to use a flow to access data in
                    hidden tables created by many-to-many relationships using a flow or otherwise. Creating custom N:N relationships
                    should also be part of Microsoft documentation, as I found there to be little help with this process. 
                  </div>
                </div>
              </div>
              <!-- End Issue -->

              <!-- Start Issue -->
              <div class="accordion-item" data-aos="fade-up" data-aos-delay="200">
                <h3 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq-content-3">
                    Subgrid on the First Tab of an Advanced Form
                  </button>
                </h3>
                <div id="faq-content-3" class="accordion-collapse collapse" data-bs-parent="#faqlist">
                  <div class="accordion-body">
                    <strong>Description: </strong>Whilst creating an advanced form with multiple tabs, I wanted to put a subgrid on the
                    first page of the form. When I implemented this and viewed the results on the corresponding webpage, the subgrid 
                    did not appear on the form – the tab was empty (there were no other elements on that tab).
                    <br><br>

                    <strong>Workaround: </strong>The subgrid had to be moved to the second tab and the first tab was turned into an
                    instructions page.
                    <br><br>

                    <strong>Suggested solution: </strong> Either it should be possible to have subgrids on the first tab of an advanced
                    form, or it should be clearly documented on
                    <a href="https://docs.microsoft.com/en-us/powerapps/maker/model-driven-apps/form-designer-add-configure-subgrid">this 
                    page</a> that subgrids cannot appear on the first tab – it took much fiddling to discover this quirk.
                  </div>
                </div>
              </div>
              <!-- End Issue -->

              <!-- Start Issue -->
              <div class="accordion-item" data-aos="fade-up" data-aos-delay="200">
                <h3 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq-content-4">
                    PowerAutomate Filter by Lookup Column
                  </button>
                </h3>
                <div id="faq-content-4" class="accordion-collapse collapse" data-bs-parent="#faqlist">
                  <div class="accordion-body">
                    <strong>Description: </strong>Assume a table (called table_1) with an arbitrary number of columns, one of which is a
                    Lookup column (called lookup_column) to another arbitrary table. A cloud flow which uses the Dataverse step
                    “List rows” with an OData filter of type
                    <span style="font-family: 'Courier New', Courier, monospace">lookup_column eq [arbitrary value]</span> will produce the following error:
                    <br><br>
                    <span style="font-family: 'Courier New', Courier, monospace;">Could not find a property named 'lookup_column' on
                      type 'Microsoft.Dynamics.CRM.table_1'.</span>
                    <br><br>

                    <strong>Workaround: </strong>We changed the OData filter to
                    <span style="font-family: 'Courier New', Courier, monospace">_lookup_column_value eq [GUID]</span>
                    <br><br>
                    
                    <strong>Suggested Solution: </strong>This quirk does not necessarily need to be changed, but it should be documented
                    that lookup columns need to be referenced in this (or another) specific way to be filtered by in PowerAutomate.
                  </div>
                </div>
              </div>
              <!-- End Issue -->

            </div>
          </div>
        </div>
      </div>
    </section><!-- End F.A.Q Section -->

  </main><!-- End #main -->

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/purecounter/purecounter.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>

</body>

</html>